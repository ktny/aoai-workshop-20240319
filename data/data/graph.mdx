---
title: グラフ
---
import Img from "../../components/Img.tsx";
import Table from "../../components/commons/Table";

:version[2.3.0]

グラフで分析する方法について、説明します。\
この機能では、シンプルな設定でグラフ形式によるデータの可視化をおこなえます。\
また、分析結果から関連性の高いインサイトが自動的に表示されますので、そこからさらに分析を掘り下げることもできます。

## グラフの作成

1. [プロジェクト詳細]画面から、画面左側の[分析]を選択します。
1. [分析]画面が表示されますので、[+分析を作成]ボタンをクリックします。
1. リレーションが設定されていないデータセットがある場合は、確認画面が表示されます。\
   表示される画面にて、[分析を作成]ボタンをクリックします。
1. [新規分析作成]画面が表示されますので、分析名を入力後、[分析種別]から[グラフ]を選択して[作成]ボタンをクリックします。
1. 作成するグラフの種類を[グラフ種別]から選択します。
1. グラフの種別に応じて設定項目が表示されますので、[追加するフィールド]からドラッグ&ドロップして追加します。

   :::note{.hint}
   ヒント

   - [追加するフィールド]には、データセットの項目、セグメント、特徴量が表示され集計に使用することができます。\
     また、各データセットをマウスオーバーすると右部に表示されるアイコンから、データのプレビューを確認できます。
   - 追加した項目をグラフの対象からはずす場合は、項目欄の外にドラッグしてください。
   - 追加した項目の順番を入れ替える場合は、項目名をドラッグ&ドロップして移動してください。
   - 値に関する項目への追加は、以下の方法でも可能です。
     - [fx]ボタン：\
       プロジェクトに登録されている数式から選択できます。
     - [+]ボタン：:version[2.4.0]\
       集計方法を選択、または数式を入力して指定することができます。\
       後述の[値の設定]画面における[クイック]、および[カスタム]と同様です。

     上記の方法で追加した場合は、後述の手順7.の集計方法の設定は不要です。
   - [リレーションプレビュー]ボタンをクリックすると、データセット間のリレーションの状態を確認することができます。\
     デフォルト以外のリレーション設定を使用する場合は、[リレーション設定]から選択してください。
   :::
1. 続けて、値に関する各項目の[▼]ボタンから集計方法や表示の設定をおこない[保存]ボタンをクリックします。

   <Img src="/assets/img/capture/capture-graph-1.png" alt="グラフ(グラフ編集)" client:load />

   [値の設定]画面では、以下の項目を設定することができます。

   - [集計設定]：
     - [クイック]：:version[2.4.0]\
       集計の対象列と集計方法を指定します。\
       集計方法は、以下のいずれかから選択してください。\
       なお、値に文字列型の項目を追加した場合は、「個数」、「ユニーク数」のいずれかから指定できます。
       | 種類                       | 説明                                                |
       | -------------------------- | --------------------------------------------------- |
       | 合計                       | レコードの合計値を計算します。                        |
       | 個数                       | レコード数を計算します。                              |
       |                            | 値が欠損しているレコードはカウントされません。         |
       | ユニーク数                 | 重複を除いたレコード数を計算します。                   |
       | 平均                       | レコードの平均値を計算します。                        |
       | 最大                       | レコードの最大値を計算します。                        |
       | 最小                       | レコードの最小値を計算します。                        |
       | 最頻                       | レコードの最頻値を計算します。                        |
       | 集計なし                   | レコードの値をそのまま使用します。                     |
       |                            | [グラフ種別]で「散布図」を選択した場合のみ選択できます。|

       上記の集計方法は、値に関する各項目の[▼]ボタンから直接設定することも可能です。

       特定のデータのみで集計したい場合は、[集計対象データのフィルター]から絞り込む条件を設定してください。\
       [+条件を追加]ボタンをクリックすると、AND条件を追加できます。
       :::note{.point}
       ポイント

       集計方法で「集計なし」を選択した場合は、すべての項目を同じデータセット内のフィールドから選択する必要があります。\
       また、すべての項目の集計方法が「集計なし」に切り換わります。
       :::
     - [カスタム]：\
       数式を入力して指定することができます。
     - [数式]：\
       プロジェクトに登録されている数式から選択できます。
   - [表示設定]：\
     数値の表示方法や表示形式を設定します。
     - [表示形式]に「標準」を設定した場合は、表示単位やプレフィックス/サフィックスを追加で設定できます。
     - [集計設定]で[数式]を選択した場合の[表示設定]の初期値を、[数式]画面から設定することができます。
:::note{.hint}
ヒント

- [説明を追加]をクリックすると、分析に説明を追加することができます。:version[2.4.0]\
  「http://」、または「https://」で始まる文字列はURLと認識され、リンクで表示されます。
  リンクは[Ctrl]キーを押しながらクリックし、表示される画面の[OK]ボタンをクリックすると開くことができます(別タブ表示)。
- グラフに設定する項目を複数の組み合わせで管理したい場合は、[グラフ]画面左下の[+]ボタンからタブを追加してください。\
  なお、タブの名前変更、複製および削除は、タブ名右横の展開ボタンからおこなえます。
- [保存]ボタン右端の展開ボタンから[別名で保存]を選択すると、設定した内容を別名で保存することもできます。\
  分析がロックされている場合は、[保存]ボタンは表示されず、[別名で保存]ボタンから別名保存のみ可能です。
:::

## 分析結果の確認

[分析]画面の一覧から、作成したグラフを選択して分析結果を確認できます。\
KIでは、作成したグラフから関連が深い項目を自動で抽出し、インサイトに表示します。\
また、インサイトから要因ツリーへ移動して、さらに分析を掘り下げることもできます。\
各項目の見方は、以下を参照してください。

<Img src="/assets/img/capture/capture-graph-2.png" alt="グラフ" client:load />

1. クリックすると、全画面表示に切り換わります。:version[2.4.0]\
   再度クリックすると、通常の画面表示に戻ります。\
   なお、全画面表示中のURLを他のユーザーに共有すると、そのURLを開いたユーザーも同様に全画面表示で閲覧することができます。
1. クリックすると、1つ前の画面に戻ります。
1. クリックすると、分析の名前を変更できます。
1. クリックすると、ブックマークに追加できます。\
   ブックマークから削除する場合は、再度アイコンをクリックしてください。
1. データセットや分析を最新の内容に更新します。\
   ボタンをクリックして表示される画面から、更新対象を指定してください。
1. クリックすると、保存した時点の内容に戻します。
1. クリックして出力形式を選択すると、分析の結果を出力できます。
   - テーブルの内容を出力したい場合：\
     [データ (.csv)]を選択してください。
   - グラフを出力したい場合：\
     [キャプチャ (.png)]を選択してください。
1. クリックすると、分析における詳細設定ができます。
   - 列設定\
     分析に使用する列を指定できます。\
     データセットの項目、セグメント、特徴量から指定することができます。

   - 表示設定:version[2.4.0]\
     以下の項目を設定できます。
     <Table
        headers={ [ "グラフ種別", "設定項目" ] }
        rows={[
          [ { value: "縦棒/積み上げ縦棒/100%積み上げ縦棒", rowSpan: 2 }, "- 行総計を表示する"],
          [ "- 列総計を表示する"],
          [ { value: "横棒/積み上げ横棒/100%積み上げ横棒", rowSpan: 2 }, "- 行総計を表示する"],
          [ "- 列総計を表示する"],
          [ { value: "線/積み上げ線/100%積み上げ線", rowSpan: 2 }, "- 行総計を表示する"],
          [ "- 列総計を表示する"],
          [ "円", "行総計を表示する" ],
          [ "散布図", "行総計を表示する" ],
          [ { value: "組み合わせ(縦棒-線)", rowSpan: 2 }, "- 行総計を表示する"],
          [ "- 列総計を表示する"],
          [ { value: "組み合わせ（積み上げ縦棒-線）", rowSpan: 2 }, "- 行総計を表示する"],
          [ "- 列総計を表示する"],
       ]}
      />
     なお、グラフの表示に関する項目は項目番号13から設定できます。
1. [+]ボタンをクリックしてフィルターを追加することにより、表示するデータを絞り込むことができます。:version[2.4.0]
   - 各フィルターの先頭に付いている丸いチェックボックスで、フィルターの有効/無効を切り換えることができます。
   - フィルターの追加時に[すべてのタブに適用]にチェックを入れると、すべてのタブに適用されるフィルターを追加することができます。
   - フィルターの色によって、適用される範囲が異なります。
     - 薄いグレー：すべてのタブに適用
     - 濃いグレー：各タブ内でのみ適用
   - フィルターをクリックすると、条件やフィルターの適用範囲を再設定することができます。\
     なお、閲覧するユーザーに応じて関連するデータで絞り込みたい場合は、[列]にデータ型が文字列型の列を指定し、条件のプルダウンから「現在のユーザーIDと一致」を選択してください。\
     [フィルターを適用するユーザー]でユーザー、およびユーザーグループを指定すると、特定のユーザーにのみフィルターを適用できます(指定外のユーザーにはフィルターが無効になります)。
   - 追加したフィルターを削除する場合は、フィルターをクリックして表示されるメニューの[フィルター削除]ボタンをクリックしてください。
1. 分析の説明が表示されます。:version[2.4.0]\
   クリックすると編集できます。
1. 作成したグラフを表示する[グラフ]パネルです。
   - グラフの設定で[色]に項目を追加している場合は、グラフ右上に色のラベル一覧が表示されます。:version[2.4.0]\
     色の各ラベルをクリックすると、該当グラフの表示/非表示を切り換えることができます。\
     なお、[色]項目の並び順は、[分析用データ]画面の[値の並び替え]の設定が適用されます。\
     [値の並び替え]の設定方法については、「[分析用データ画面](/guide/project-details/index.html#分析用データ画面)」を参照してください。
   - グラフ上のデータを選択すると、テーブルの該当セルにグラフと同じ色の枠でハイライト表示されます。\
     また、テーブルのセルを選択すると、該当のグラフがハイライト表示されます。
   - グラフ上のデータ、またはテーブルのセルをクリックすると、そのデータに関連する分析用データとインサイトが画面右側に表示されます。\
     非選択の状態では、グラフ全体に関連する分析用データとインサイトが表示されます。
   - グラフ上のデータをダブルクリックすると、該当するデータの詳細を確認できます。\
     [分析用データ表示]画面の見方については、項目番号20を参照してください。
   - グラフ上でマウスホイールを動かすと、グラフの表示倍率を変更できます。
1. クリックすると、グラフの色を変更できます。:version[2.4.0]
   - グラフの[色]項目に複数のフィールドを設定している場合、[設定する色フィールド]のプルダウンから親フィールドの階層を選択して色の指定をすることで、子フィールドにも親フィールドと同じ色を適用できます。
   - [デフォルトの色を適用]ボタンをクリックすると、すべてのフィールドの色設定が標準の配色で上書きされます。
1. クリックすると、グラフの表示に関する詳細設定ができます。:version[2.4.0]\
   グラフ種別によって設定できる項目が異なります。\
   設定できる項目は以下のとおりです。
   <Table
      headers={ [ "グラフ種別", "設定項目" ] }
      rows={[
        [ { value: "縦棒/積み上げ縦棒/100%積み上げ縦棒", rowSpan: 7 }, "- 表示設定" ],
        [ "　- 数値表示" ],
        [ "　- ％表示(100%積み上げ縦棒のみ)" ],
        [ "　- 色のラベルを表示する" ],
        [ "- 横軸の並び順" ],
        [ "- 表示範囲(縦棒/積み上げ縦棒のみ)"],
        [ "　- 縦軸"],
        [ { value: "横棒/積み上げ横棒/100%積み上げ横棒", rowSpan: 7 }, "- 表示設定" ],
        [ "　- 数値表示" ],
        [ "　- ％表示(100%積み上げ横棒のみ)" ],
        [ "　- 色のラベルを表示する" ],
        [ "- 縦軸の並び順" ],
        [ "- 表示範囲(横棒/積み上げ横棒のみ)"],
        [ "　- 横軸"],
        [ { value: "線/積み上げ線/100%積み上げ線", rowSpan: 8 }, "- 表示設定" ],
        [ "　- マーカー表示" ],
        [ "　- 数値表示" ],
        [ "　- ％表示(100%積み上げ線のみ)" ],
        [ "　- 色のラベルを表示する" ],
        [ "- 横軸の並び順" ],
        [ "- 表示範囲(線/積み上げ線のみ)"],
        [ "　- 縦軸"],
        [ { value: "円", rowSpan: 5 }, "- 表示設定" ],
        [ "　- 数値表示" ],
        [ "　- ％表示" ],
        [ "　- 色のラベルを表示する" ],
        [ "- 並び順" ],
        [ { value: "散布図", rowSpan: 7 }, "- 表示設定" ],
        [ "　- 数値表示" ],
        [ "　- 色のラベルを表示する" ],
        [ "　- マーカーにラベルをつける" ],
        [ "- 表示範囲"],
        [ "　- 縦軸"],
        [ "　- 横軸"],
        [ { value: "組み合わせ（縦棒 - 線）", rowSpan: 12 }, "- 表示設定(全体)" ],
        [ "　- 色のラベルを表示する" ],
        [ "- 横軸の並び順(全体)" ],
        [ "- 表示設定(縦棒)" ],
        [ "　- 数値表示"],
        [ "- 表示範囲(縦棒)"],
        [ "　- 縦軸"],
        [ "- 表示設定(線)" ],
        [ "　- マーカー表示"],
        [ "　- 数値表示"],
        [ "- 表示範囲(線)"],
        [ "　- 縦軸"],
        [ { value: "組み合わせ（積み上げ縦棒 - 線）", rowSpan: 12 }, "- 表示設定(全体)" ],
        [ "　- 色のラベルを表示する" ],
        [ "- 横軸の並び順(全体)" ],
        [ "- 表示設定(積み上げ縦棒)" ],
        [ "　- 数値表示"],
        [ "- 表示範囲(積み上げ縦棒)"],
        [ "　- 縦軸"],
        [ "- 表示設定(線)" ],
        [ "　- マーカー表示"],
        [ "　- 数値表示"],
        [ "- 表示範囲(線)"],
        [ "　- 縦軸"],
     ]}
   />
1. クリックすると、[テーブル]パネルの表示/非表示を切り換えることができます。\
   また、その横の境界線を上下にドラッグすることにより、表示域の高さ調整ができます。
1. テーブル形式で集計値を表示する[テーブル]パネルです。\
   テーブルのセルをダブルクリックすると、該当するデータの詳細を確認できます。\
   [分析用データ表示]画面の見方については、項目番号20を参照してください。
1. 分析を複数のタブで管理できます。\
   集計する項目を複数の組み合わせで分析したい場合などに利用できます。\
   タブの編集方法については、前述の「[グラフの作成](#グラフの作成)」の手順7.のヒントを参照してください。
1. クリックすると、画面右側の表示を開閉できます。
1. クリックすると[分析]タブに切り換わり、インサイトを確認できます。
1. クリックすると[グラフ編集]タブに切り換わり、グラフの設定を編集することができます。\
   編集方法については、前述の「[グラフの作成](#グラフの作成)」の手順5.以降を参照してください。
1. 関連するデータセットを確認できます。:version[2.4.0]\
   グラフやテーブル上でデータを選択していない場合は、分析に使用しているすべてのデータセットが表示され、グラフやテーブル上でデータを選択した場合は、選択したデータに関連するデータセットが表示されます。\
   また、[分析用データ表示]画面にて以下の操作が可能です。
     - 画面上部の[+]ボタンをクリックするか項目の値をダブルクリックしてフィルターを追加すると、表示するデータを一時的に絞り込むことができます。
       - 追加した各フィルターの先頭に付いている丸いチェックボックスで、フィルターの有効/無効を切り換えることができます。
       - 追加したフィルターを削除する場合は、フィルターをクリックすると表示されるメニューの[フィルター削除]ボタンをクリックしてください。\
         なお、項目の値をダブルクリックして追加したフィルターであれば、再度同じ値をダブルクリックすることでも削除できます。
       - フィルターをクリックすると、条件を再設定できます。\
         なお、閲覧するユーザーに応じて関連するデータで絞り込みたい場合は、[列]にデータ型が文字列型の列を指定し、条件のプルダウンから「現在のユーザーIDと一致」を選択してください。\
       　[フィルターを適用するユーザー]でユーザー、およびユーザーグループを指定すると、特定のユーザーにのみフィルターを適用できます(指定外のユーザーにはフィルターが無効になります)。

       なお、変更したフィルター設定は、画面を閉じるとリセットされます。
   - 各列のヘッダーをダブルクリックすることで、列をテーブルの左側に固定することができます(複数列可)。\
     再度ダブルクリックすると、固定が解除されます。
   - [リストビューを作成]ボタンをクリックすると、表示されているデータセットの内容でリストビューを作成できます。
   - 表示されているデータセットの内容を[エクスポート]ボタンからエクスポートできます。\
     出力する形式を以下のいずれかから選択し、必要項目を入力の上、[出力]ボタンをクリックしてください。
     | 出力形式                      | 設定内容                                                                                             |
     | ---------------------------- | ---------------------------------------------------------------------------------------------------- |
     | CSVファイル出力               | 出力するファイル名と区切り文字を指定します。                                                            |
     | データベースに出力            | データベースの接続情報と出力先のテーブルを指定します。                                                   |
     |                              | 設定方法の詳細は、「[各種データベースに出力](/guide/output-to-database/index.html)」を参照してください。 |
     | KI内のデータセットとして出力   | [新規作成]、または[既存データセットを上書き]のいずれかから選択します。                                   |
     |                              |  - [新規作成]を選択した場合：データセットの出力先を選択します。                                          |
     |                              |  - [既存データセットを上書き]を選択した場合：上書きするデータセットを選択します。                         |

1. インサイトが表示されます。
   - グラフやテーブル上でデータを選択していない場合は、全体に対するインサイトが表示され、データを選択した場合は、選択したデータに対するインサイトが表示されます。
   - カード上にマウスオーバーすると、比較対象のデータがグラフやテーブル上でハイライト表示されます。
     - カードとハイライトを固定する場合：\
       カードをクリックしてください。\
       解除する場合は、再度カードをクリックしてください。
     - 要因ツリーで分析をする場合：\
       [要因ツリーで分析]ボタンをクリックしてください。\
       要因ツリーについては、「[要因ツリー](/guide/factor-analysis/index.html)」を参照してください。
1. クリックすると、データセット間のリレーションの状態を確認することができます。\
   使用するリレーションを変更する場合は、右上の[リレーション設定]からリレーションを選択してください。
1. クリックすると、設定した内容を保存します。
   - 右端の展開ボタンから[別名で保存]を選択すると、別名で保存することもできます。
   - 分析がロックされている場合は、[保存]ボタンは表示されず、[別名で保存]ボタンから別名保存のみ可能です。
