---
title: サンプリング
---
import Img from "../../components/Img.tsx";

大規模なデータでAFEを実行する方法について説明します。\
通常、大規模なデータを用いたデータの加工、および分析には、計算処理に多くの時間を要してしまいます。\
そこで、KIでは大規模データを一定量まで絞り込むことにより、データを扱いやすくするサンプリング機能を用意しています。\
このサンプリング機能を用いることにより、データの加工～AFEでの分析/施策までを手早く効率的におこない、データの傾向を確認することができます。その後、絞り込む前の大規模データに置き換えてAFEを実施することもできます。

なお、サンプリングの方法については、以下の種類があります。

- ランダムサンプリング：\
  ランダムに行を絞り込むことができます。\
  データ量を単純に絞り込みたい場合に適しています。
- スマートサンプリング：\
  サンプリング元のデータに対し、照合用のデータと紐づけができる行だけが残るように絞り込むことができます。

  <Img src="/assets/img/capture/capture-sampling-7.png" alt="サンプリング" client:load />

:::note{.hint}
ヒント

- 複数データセットを用いてAFEを実行する場合は、ランダムサンプリングとスマートサンプリングを使い分けると便利です。\
  マスタデータとトランザクションデータをそれぞれランダムサンプリングしてしまうと、AFEの結果がサンプリング前と異なってしまいます。

  NG
  <Img src="/assets/img/capture/capture-sampling-8.png" alt="サンプリング" client:load />

  これを避けるには、まずマスタデータをランダムサンプリングして、間引いたデータセットを作成します。\
  このデータセットを照合データとして、トランザクションをスマートサンプリングすると、AFEの結果が正しく計算されます。

  OK
  <Img src="/assets/img/capture/capture-sampling-9.png" alt="サンプリング" client:load />

- ランダムサンプリングについては、[ワークフロー]画面のデータ編集から実施することもできます。\
  詳細は、「[サンプリング](/guide/shaping/index.html#サンプリング)」を参照してください。
  :::

## サンプリングデータの作成方法

1. [データセット一覧]画面でサンプリング元となるデータセットを選択後、[サンプリング]アイコン(以下画面の青枠部分)をクリックします。

   <Img src="/assets/img/capture/capture-sampling-1.png" alt="[データセット一覧]画面" client:load />

1. [サンプリング]画面が表示されますので、各種設定をおこない[次へ]ボタンをクリックします。

   - 「ランダム」を選択した場合
     <Img src="/assets/img/capture/capture-sampling-2.png" alt="サンプリング画面" client:load />

     1. サンプリング後の新しいデータセットの名前を入力します。
     1. 指定した量に応じてランダムに行を絞り込みます。

        - [パーセント]：全データの内、指定した割合まで行を絞り込みます。\
          値は、0～100の範囲で指定できます。
        - [行数]：全データの内、指定した行数まで行を絞り込みます。\
          行数は、1～全データの行数の範囲で指定できます。

   - 「スマート」を選択した場合
     <Img src="/assets/img/capture/capture-sampling-3.png" alt="「スマート」を選択した場合" client:load />
     1. サンプリング後の新しいデータセットの名前を入力します。
     1. 照合用のデータセットを[選択]ボタンから選択します。
     1. サンプリング元のデータセットと照合用のデータセットの関連付け(共通キー)をプルダウンから選択します。関連付けができたデータのみを残し、サンプリングされます。共通キーの組み合わせは、3つまで指定できます。

1. [サンプリング完了]画面が表示され、絞り込んだ内容がプレビュー表示されますので内容を確認して[OK]ボタンをクリックします。

<Img src="/assets/img/capture/capture-sampling-4.png" alt="サンプリング完了" client:load />

[データセット一覧]画面にサンプリングしたデータセットが追加されます。

:::note{.hint}
ヒント

- サンプリングデータのデータセットは、以下のアイコンで表示されます。

| アイコン                                                                    | 説明                                                        |
| -------------------------------------------------------------------------- | ----------------------------------------------------------- |
| :big-icon[/assets/img/common/icon-document-csv-sampling.svg,CSV]           | データセット(CSVファイル)を元に作成したサンプリングデータ      |
| :big-icon[/assets/img/common/icon-database-sampling.svg,データベース]       | データセット(データベース)を元に作成したサンプリングデータ     |
| :big-icon[/assets/img/common/icon-document-excel-sampling.svg,EXCEL]       | データセット(EXCELファイル)を元に作成したサンプリングデータ    |
| :big-icon[/assets/img/common/icon-document-tableau-sampling.svg,Tableau]   | データセット(Tableau)を元に作成したサンプリングデータ          |

- サンブリングされたデータを再度サンプリングすることはできませんが、照合用のデータとして使うことはできます。
  :::

## サンプリングデータをサンプリング元のデータに置換する方法

[ワークフロー]画面の[サンプリング元データに置換]ボタン(以下画面の青枠部分)をクリックすることにより、ワークフローで使用しているすべてのサンプリングデータをサンプリング元のデータに一括で置換できます。

<Img src="/assets/img/capture/capture-sampling-5.png" alt="サンプリング元データに置換" client:load />

## サンプリングデータの編集方法

[データセット一覧]画面上で、サンプリングデータのデータセットにマウスカーソルを合わせると、編集メニューが表示されます。

<Img src="/assets/img/capture/capture-sampling-6.png" alt="サンプリングデータの編集" client:load />

1. サンプリングデータの内容をプレビュー表示します。:version[2.1.6]\
   プレビュー表示では、各列のヘッダーをダブルクリックすることで、列をテーブルの左側に固定することができます(複数列可)。\
   再度ダブルクリックすると、固定が解除されます。
1. サンプリングデータを使用しているプロジェクトの一覧が表示されます。
1. 絞り込み条件を再編集できます。再編集すると新しい設定で改めてサンプリング元のデータから絞り込みをおこない、既存のサンプリングデータを上書きします。
1. 前回実施時と同じ条件でデータを絞り込み、既存のサンプリングデータを上書きします。
1. サンプリングしたデータセットの共有設定ができます。\
   ユーザーの権限種別と利用できる機能については、「[ユーザーの権限種別と利用できる機能](/guide/user-management/index.html#ユーザーの権限種別と利用できる機能)」を参照してください。 なお、初期設定では、サンプリング元のデータセットの権限が継承されます。
1. サンプリングデータを削除できます。
