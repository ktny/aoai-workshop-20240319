---
title: 結合
---
import Img from "../../components/Img.tsx";

データセットを結合する方法について説明します。\
結合を実施すると、結合した結果が新しいデータセットとして追加されます。

1. [プロジェクト詳細]画面から、画面左側の[ワークフロー]を選択します。
1. [ワークフロー]画面上で、結合する2つのデータセットを[Shift&#093;([Ctrl])キー+左クリックして選択します。
1. [アクション]パネルに[結合]ボタンが表示されますので、クリックします。

   <Img src="/assets/img/capture/capture-join-1.png" alt="ワークフロー画面" client:load />

1. 結合の設定をするパネルが表示されますので、各種設定をおこない[実行]ボタンをクリックします。\
   [ワークフロー]画面上に、結合した結果が新しいデータセットとして追加されます。

   <Img src="/assets/img/capture/capture-join-2.png" alt="結合の設定" client:load />

   1. 編集内容の説明やメモを追加することができます。:version[2.4.0]\
      「http://」、または「https://」で始まる文字列はURLと認識され、リンクで表示されます。リンクは[Ctrl]キーを押しながらクリックし、表示される画面の[OK]ボタンをクリックすると開くことができます(別タブ表示)。\
      入力した内容を確定するには、入力欄からフォーカスをはずすか[Shift]+[Enter]キーを押してください。
   1. プルダウンから結合する条件(対応する列)を選択します。
   1. 左右のテーブルを入れ替えることができます。
   1. 結合するキーを追加できます。
   1. 結合の種類を選択します。結合の種類についての詳細は、後述の「[結合の種類](#結合の種類)」を参照してください。
   1. クリックすると、列の一覧が表示され、結合後に残す列を指定できます。\
      詳細は、後述の「[列選択](#列選択)」を参照してください。
   1. チェックを入れた場合は、30,000行以上データがある場合も、全件のデータを用いて結合します。\
      チェックをはずした場合は、すべてのデータのうち、最大30,000件のデータを用いて結合します。
   1. 結合後のテーブルに両テーブルの結合キーを残す場合は、チェックを入れてください。:version[2.1.4]\
      チェックをはずした場合は、以下に従って片方の結合キーのみが結合後のテーブルに残ります。
      - 内部結合、左外部結合、または完全外部結合の場合：\
        左側のテーブルにある結合キーが残ります。
      - 右外部結合の場合：\
        右側のテーブルにある結合キーが残ります。
   1. テーブル同士が多対多の関係でも強制的に結合する場合は、チェックを入れてください。:version[2.1.4]\
      なお、多対多の結合においては、計算処理に時間を要する可能性があります。
   1. プレビューを表示できます。

   ## 結合の種類

   | 結合タイプ   | 説明                                                             |
   | ------------ | ---------------------------------------------------------------- |
   | 内部結合     | 結合キーのデータが両方に存在するデータ行のみを残して結合します。 |
   | 左外部結合   | 左側のテーブルにあるデータ行を残して結合します。                 |
   |              | 結合キーが左側にしかない列は、右側部分はNULLになります。         |
   |              | 結合キーが右側にしかない列は、削除されます。                     |
   | 右外部結合   | 右側のテーブルにあるデータ行を残して結合します。                 |
   |              | 結合キーが右側にしかない列は、左側部分はNULLになります。         |
   |              | 結合キーが左側にしかない列は、削除されます。                     |
   | 完全外部結合 | 両方のテーブルのデータ行をすべて残して結合します。               |
   |              | 結合キーが左側にしかない列は、右側部分はNULLになります。         |
   |              | 結合キーが右側にしかない列は、左側部分はNULLになります。         |

   例)以下の2つのデータセットを購入商品IDと商品IDで結合する場合、結合の種類によって結果が以下のように変わります。

   <Img src="/assets/img/capture/capture-join-4.png" alt="結合の種類" client:load />

   ### 内部結合

   <Img src="/assets/img/capture/capture-join-5.png" alt="内部結合" client:load />

   両方のデータセットにある商品ID1,2のデータだけが残ります。

   ### 左外部結合

   <Img src="/assets/img/capture/capture-join-6.png" alt="左外部結合" client:load />

   両方のデータセットにある商品ID1,2のデータが残ります。それに加え、左側のデータセットだけにある購入商品ID=4のデータも残ります。

   ### 右外部結合

   <Img src="/assets/img/capture/capture-join-7.png" alt="右外部結合" client:load />

   両方のデータセットにある商品ID1,2のデータが残ります。それに加え、右側のデータセットだけにある商品ID=3のデータも残ります。

   ### 完全外部結合

   <Img src="/assets/img/capture/capture-join-8.png" alt="完全外部結合" client:load />

   両方のデータセットにある商品ID1,2のデータが残ります。それに加え、片側のデータセットだけにある購入商品ID=4、商品ID=3のデータも残ります。

   ## 列選択

   アクションパネルの表示が以下のように切り換わりますので、結合後に残す列のチェックボックスにチェックを入れてください。\
   なお、データセット名にチェックを入れると、表示されている項目を一括で選択することができます。

   <Img src="/assets/img/capture/capture-join-3.png" alt="列選択" client:load />
