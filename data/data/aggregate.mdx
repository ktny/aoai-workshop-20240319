---
title: 集計
---
import Img from "../../components/Img.tsx";

データセットを集計する方法について説明します。\
集計を実施すると、集計した結果が新しいデータセットとして追加されます。

1. [プロジェクト詳細]画面から、画面左側の[ワークフロー]を選択します。
1. [ワークフロー]画面上で、集計するデータセットを選択します。
1. [アクション]パネルに[集計]ボタンが表示されますのでクリックします。

   <Img src="/assets/img/capture/capture-aggregate-1.png" alt="ワークフロー画面" client:load />

1. 集計の設定をするパネルが表示されますので、各種設定をおこない[実行]ボタンをクリックします。\
   [ワークフロー]画面上に、集計した結果が新しいデータセットとして追加されます。

   <Img src="/assets/img/capture/capture-aggregate-2.png" alt="集計の設定" client:load />

   1. 編集内容の説明やメモを追加することができます。:version[2.4.0]\
      「http://」、または「https://」で始まる文字列はURLと認識され、リンクで表示されます。リンクは[Ctrl]キーを押しながらクリックし、表示される画面の[OK]ボタンをクリックすると開くことができます(別タブ表示)。\
      入力した内容を確定するには、入力欄からフォーカスをはずすか[Shift]+[Enter]キーを押してください。
   1. 集計方法は、[通常集計]、または[期間集計]から選択します。
      - [通常集計]：\
        グループ化する列の同じ値ごとに集計を計算します。
      - [期間集計]：
        - 「年ごと」、「月ごと」、「日ごと」など、一定期間ごとに集計できます。また、通常集計のようにグループ化する列を加えて集計することもできます。
        - データセットに時系列データが含まれる場合のみ指定することができます。
        - 期間集計をすると、元データの順序に関係なく&#091;期間列](後述の項目番号3で指定する)を基準に昇順ソートした集計結果が新しいデータセットとして追加されます。
   1. 期間列と集計単位をプルダウンから選択します。\
      集計単位に「年ごと」、「月ごと」、「週ごと」のいずれかを指定した場合は、集計の始点をあわせて指定できます。
      \
      例)[集計単位]を「月ごと」で、[始点]を「20日」とした場合、各月の20日～翌月の19日までを1グループとして集計します\
      \
      この項目は、項目番号2で[期間集計]を選択した場合のみ表示され、入力必須の項目となります。
   1. グループ化する列を指定します。複数列を指定できます。\
      項目番号2で[期間集計]を選択した場合は、この項目で指定した列に加えて、項目番号3で指定した期間で集計されます。
   1. 集計に用いる関数、および集計対象の列を指定します。複数列を指定できます。\
      [対象]列で「すべての列」を選択した場合は、データセットのすべての列を対象として集計します。ただし、指定した関数で扱えるデータ型のみが対象となります。\
      指定できる関数の詳細については、後述の「[集計の種類](#集計の種類)」を参照してください。
   1. チェックを入れた場合は、30,000行以上データがある場合も、全件のデータを用いて集計します。\
      チェックをはずした場合は、すべてのデータのうち、最大30,000件のデータを用いて集計します。
   1. クリックするとプレビューを表示できます。

   ## 集計の種類

   | 関数           | 対象のデータ型         | 説明                                           |
   | -------------- | ---------------------- | ---------------------------------------------- |
   | ANY            | すべて                 | 任意の一つのデータを抽出します。               |
   | ANY NOT NULL   | すべて                 | NULLを除いた任意の一つのデータを抽出します。   |
   | AVERAGE        | 整数型、小数型、論理型 | NULLを除いた数値データの平均値を算出します。   |
   | COUNT          | すべて                 | データの個数(=行数)を算出します。              |
   | COUNT NOT NULL | すべて                 | NULLを除いたデータの個数を算出します。         |
   | COUNT DISTINCT | すべて                 | NULLと重複を除いたデータの個数を算出します。   |
   | MAX            | 文字列型、論理型以外   | データの最大値を出力します。                   |
   | MIN            | 文字列型、論理型以外   | データの最小値を出力します。                   |
   | STDEV          | 整数型、小数型         | NULLを除いた数値データの標準偏差を算出します。 |
   | SUM            | 整数型、小数型、論理型 | NULLを除いた数値データの合計値を算出します。   |
   | VAR            | 整数型、小数型         | NULLを除いた数値データの分散を算出します。     |
   | MEDIAN         | 文字列型、論理型以外   | NULLを除いた数値データの中央値を算出します。   |
